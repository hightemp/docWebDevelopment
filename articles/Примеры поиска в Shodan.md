#  Примеры поиска в Shodan

 Эта статья предназначена для тех, кто либо вовсе не слышал о Shodan, либо слышал, но так и не понял, как им пользоваться. Подобных материалов на русском языке я не нашел, часть информации почерпнул  [тут](http://www.scribd.com/doc/34507835/SHODAN-for-Penetration-Testers-The-Next-HOPE)  , остальное добавил из личного опыта. Я приведу примеры использования  [«самого страшного поисковика интернета»](http://habrahabr.ru/post/178501/)  по имени Shodan. Сервис разработан web-девелопером Джоном Мазерли (John Matherly) и ориентирован, прежде всего, на поиск устройств подключенных к интернету.   
  
 Shodan опрашивает порты устройств и на основе полученных ответных баннеров делает выводы об устройствах и сервисах. Поисковик платный, годовая подписка обойдется в 20$, однако, попробовать его в действии можно и за так: после бесплатной регистрации доступно 50 результатов поиска. Историю создания и биографию автора найдете сами, если будет интересно, а пока перейдем к делу:   
  

####  [Фильтры](http://www.shodanhq.com/help/filters) 

  
 Результаты поиска можно фильтровать с помощью следующих конструкций:   

*   country: страна, в формате RU, UK, US и т.д., например: nginx country:RU
*   city: город, например: nginx city:«Moscow» country:RU
*   os: операционная система, например: microsoft-iis os:«windows 2003»
*   port: порт в формате 21, 80, 443 и тд, например: proftpd port:21
*   hostname: позволяет искать с учетом домена, например: nginx hostname:.de

  
  

#### Пример 1: Устройства Cisco

  
 Для того, чтобы понять первый пример необходимо вспомнить, как основные коды HTTP-ответов:   
 [Коды состояния HTTP](https://ru.wikipedia.org/wiki/%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D0%BA%D0%BE%D0%B4%D0%BE%D0%B2_%D1%81%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D1%8F_HTTP)  :   

*   200 OK Request succeeded;
*   301 MovedPermanently Assigned a new permanentURI;
*   302 FoundResides under a different URI;
*   401 Unauthorized Request requires authentication;
*   403 ForbiddenRequest is denied regardlessof authentication.

  
  
 В данном примере мы попробуем найти устройства-cisco с web-интерфейсом для доступа к которым не требуется авторизация.   
 Для начала посмотрим, как выглядит типичный «401 Unauthorized» баннер устройства-cisco, если в строке поиска мы введем просто «cisco»:   
  
 _HTTP/1.0 401 Unauthorized  
Date: Thu, 20 Oct 1994 05:18:36 GMT  
Server: cisco-IOS  
Connection: close  
Accept-Ranges: none  
WWW-Authenticate: Basic realm=«level\_15\_access»_   
  
 Обратите внимание, что строка  _«WWW-Authenticate: Basic realm=»level\_15\_access"_  указывает на необходимость ввести логин и пароль.   
 В свою очередь, устройство авторизация в котором не требуется, вернет нам баннер со статусом 200 (для этого в строке поиска вбиваем «200 cisco», еще строка Last-Modified — верный признак, что это «наш клиент»:   
  
 _HTTP/1.0 200 OK  
Date: Mon, 08 Sep 2014 22:28:16 GMT  
Server: cisco-IOS  
Connection: close  
Transfer-Encoding: chunked  
Content-Type: text/html  
Expires: Mon, 08 Sep 2014 22:28:16 GMT  
Last-Modified: Mon, 08 Sep 2014 22:28:16 GMT  
Cache-Control: no-store, no-cache, must-revalidate  
Accept-Ranges: none_   
  
 Достаточно перейти по ссылке ip-адрес:80 и мы попадаем в web-консоль управления устройством. Я скачал Cisco SDM для удобства.   
  
 ![](/images/0a46aebc640b6376cf7837598f2d7b69.jpg)   
  

#### Пример 2: Пароли по умолчанию

  
 К интернету подключено множество устройств с дефолтными логинами и паролями, давайте попробуем что-нибудь найти. Для этого в строке поиска пишем «default+password». Добавим также port:80, чтобы выбрать устройства с www-аутентификацией.   
  
 ![](/images/70eadd6a4e18435eea4adfb6a7ba1e84.jpg)   
  
 В результате мы увидим множество баннеров, содержащих искомую фразу, и, как показывает практика, большой процент устройств будут иметь логин/пароль вида admin/password, admin/pass, и т.д.,   
  
 ![](/images/5119f23684e6ba80cb9f0dce169059aa.jpg)   
  

#### Пример 3: Камеры видеонаблюдения

  
 Если в случае сетевых устройств пользователи в большинстве случаев устанавливают более-менее надежные пароли, то с остальным оборудованием дела обстоят намного хуже. В этом примере мы посмотрим в камеры видеонаблюдения. По работе мне часто приходится сталкиваться с видеорегистраторами фирмы DVR, некоторые из них имеют выход в сеть. Пишем в строке поиска: DVR port:80 country:RU city:«Saint Petersburg» И получаем список видеорегистраторов в СПБ, обнаружилось около 200 устройств.   
  
 ![](/images/17893e0750e786bc3fa1b10942029802.jpg)   
  
 Стандартные учетные записи на таких устройствах admin и user, пароли: admin, user, 1111, 1234, 123456, 8888 (можно найти в инструкциях). Уже на первой странице устройство со стандартной учетной записью:   
  
 ![](/images/db392ef6ebc36d09aad99b9c715b18b3.jpg)   
  

#### Пример 4: Популярные запросы

  
 ![](/images/41f5baed72c556c29deb03737f00b445.jpg)   
  
 В разделе Popular Searches, можно подсмотреть варианты запросов, вот, например, поиск ip-видеокамер фирмы avtech на территории США: linux upnp avtech country:US, добавим к нему привычный фильтр port:80:   
  
 ![](/images/703d7718cdf47189e2a31b50495bb906.jpg)   
  
 И снова на первой странице поиска попадается устройство, в котором получилось залогинится с помощью admin/admin:   
  
 ![](/images/16f81af231616621af606cf0be24601a.jpg)   
  

#### Итоги

  
 Подводя итоги, хочу лишний раз напомнить всем пользователям: пожалуйста, устанавливайте надежные пароли на ВСЕ устройства подключенные к сети, если у вас в видеорегистраторе или smart-тв нет «секретных» данных это еще не значит, что эти устройства не могут стать целями злоумышленников, пусть даже просто ради развлечения.   
  

#### Ссылки

  
 [http://www.scribd.com/doc/34507835/SHODAN-for-Penetration-Testers-The-Next-HOPE](http://www.scribd.com/doc/34507835/SHODAN-for-Penetration-Testers-The-Next-HOPE)  — Презентация с примерами (англ.).   
 [http://vimeo.com/13465839](http://vimeo.com/13465839)  — Видео по использованию (англ.).   
 [— Твиттер Джона Мазерли](http://twitter.com/achillean)   
 [— официальный user guide (англ.)](http://www.shodanhq.com/help)